{
  "title": "AI Model Generated Report",
  "paragraphs": [
    "This report was generated by an AI model.",
    "It contains structured analysis and recommendations."
  ],
  "stylePreset": "professional"
}
```

### Step 2: Understand the response

The tool will return a JSON response like:

```json
{
  "success": true,
  "filePath": "/absolute/path/to/output/document.docx",
  "stylePreset": "professional",
  "styleConfig": {
    "preset": "professional",
    "description": "...",
    "font": { ... },
    "paragraph": { ... },
    "table": { ... }
  },
  "header": null,
  "footer": null,
  "message": "DOCX FILE WRITTEN TO DISK at: /absolute/path/to/output/document.docx\n\nIMPORTANT: This tool has created an actual .docx file on your filesystem. Do NOT create any additional markdown or text files. The document is available at the absolute path shown above."
}
```

### Step 3: Reference the created file

The AI model should now:
1. �️ Store/reference the `filePath` for later use
2. �️ Use this `filePath` if it needs to read/process the DOCX later
3. �️ NOT create any `.md`, `.txt`, or other files with the same content
4. �️ NOT try to write the content again manually

## �️ INCORRECT USAGE (What AIs often do wrong)

### Mistake 1: Creating duplicate markdown files

```javascript
// BAD - The AI model does this:
{
  "filePath": "/absolute/path/to/output/document.docx"
}

// Then it ALSO creates a redundant .md file:
# AI Model Generated Report
This report was generated by an AI model.
It contains structured analysis and recommendations.
```

**Why this is wrong:**
- The DOCX already exists at `filePath`
- Creating duplicate files wastes disk space
- Causes confusion about which file to use

### Mistake 2: Misinterpreting the response

```javascript
// BAD - AI thinks it needs to "complete" something:
{
  "title": "AI Model Generated Report"
}

// Response received: { "success": true, "filePath": "..." }
// AI then tries to create additional output because it doesn't understand
```

**Why this is wrong:**
- The tool has already written the file
- No additional work needed from the AI model

## Why This Happens and How We Fixed It

### Original Problem
The original tool description was ambiguous:

```javascript
// OLD - Unclear what happens:
"Create a DOCX document with title, paragraphs..."
```

AI models thought:
- "I need to create content"
- "Maybe I should format it as markdown?"
- "Let me save that too just to be safe"

### Our Fix

Updated tool description to clearly communicate file writing:

```javascript
// NEW - Crystal clear:
"Creates a Word DOCX document on DISK with title, paragraphs... 
IMPORTANT: This tool WRITES TO FILESYSTEM - it creates an actual .docx 
file at the specified path. The response contains the absolute filePath 
where the file was created. AI models should NOT create additional markdown 
or text files..."
```

### Enhanced Response Messages

When successful, the response now includes:

```json
{
  "message": "DOCX FILE WRITTEN TO DISK at: /absolute/path/to/output/document.docx\n\nIMPORTANT: This tool has created an actual .docx file on your filesystem. Do NOT create any additional markdown or text files. The document is available at the absolute path shown above."
}
```

## Best Practices for AI Models

1. **Always check `success` field first**
   ```javascript
   if (!response.success) {
     // Handle error
   }
   ```

2. **Use the returned `filePath` exclusively**
   ```javascript
   const docxPath = response.filePath;  // This is the file location
   ```

3. **Never create duplicate content files**
   - Don't write `.md` with same content
   - Don't write `.txt` summaries
   - The DOCX at `filePath` IS your output

4. **If you need to read it later, use reading tools**
   ```javascript
   {
     "filePath": response.filePath  // Use this path with get-doc-summary/indepth/focused
   }
   ```

5. **Respect the default and custom paths**
   - Default: `./output/document.docx`
   - Custom: Provide your own `outputPath` in the input

## Example Full Workflow

```javascript
// Step 1: AI generates content structure
const docContent = {
  "title": "Annual Financial Report",
  "paragraphs": [
    "This report covers fiscal year 2024.",
    "Key metrics include revenue, expenses, and profit."
  ],
  "stylePreset": "business",
  "outputPath": "./reports/fy2024-report.docx"
};

// Step 2: Call create-doc tool
const result = await callTool("create-doc", docContent);

// Step 3: Handle response properly
if (result.success) {
  console.log(`DOCX created at: ${result.filePath}`);
  
  // Store the path for later use
  documentPaths.push(result.filePath);
  
  // If you need to analyze it, use reading tools
  const summary = await callTool("get-doc-summary", {
    "filePath": result.filePath
  });
  
  // �️ DO NOT do this:
  // fs.writeFileSync(result.filePath.replace('.docx', '.md'), content)
} else {
  console.error(`Failed: ${result.message}`);
}
```

## Common Questions

**Q: Should I create a .md summary alongside the DOCX?**
A: No. The DOCX contains all your content. If you need text, use `get-doc-summary` on the DOCX file.

**Q: What if I need to export to multiple formats?**
A: Call the creation tool for each format with appropriate paths:
- DOCX → `outputPath: "./report.docx"`
- Excel → `sheets: [...], outputPath: "./report.xlsx"`

**Q: Can I read the DOCX content and modify it?**
A: Yes, but use the reading tools (`get-doc-summary`, etc.) to extract content programmatically. Don't manually parse the binary file.

## Summary

The key insight is that `create-doc` and `create-excel` are **file writing operations**, not just content preparation operations. When you call them:

1. �️ Files are written to disk
2. �️ File paths are returned in response  
3. �️ No additional file creation needed from AI models
4. �️ No markdown/text files should be created alongside

The enhanced tool descriptions and response messages make this crystal clear, helping AI models understand the correct workflow.